<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Modal Integration Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto p-4">
        <h1 class="text-2xl font-bold mb-4">Edit Modal Integration Test</h1>
        
        <div class="bg-white rounded-lg p-6 shadow-lg mb-6">
            <h2 class="text-lg font-bold mb-4">Test Instructions</h2>
            <ol class="list-decimal list-inside space-y-2">
                <li>Open the main application: <a href="http://localhost:8000" class="text-blue-600 underline" target="_blank">http://localhost:8000</a></li>
                <li>Open browser developer tools (F12)</li>
                <li>Check the Console tab for any error messages about edit buttons</li>
                <li>Select a language from the dropdown</li>
                <li>Create a test flashcard with any word/phrase</li>
                <li>Click the "Edit" button on the flashcard to open the edit modal</li>
                <li>In the edit modal, try clicking the "üé® Generate Image" button</li>
                <li>Check if it works or shows any console errors</li>
                <li>Copy the console debug script below and paste it into the browser console for detailed debugging</li>
            </ol>
        </div>
        
        <div class="bg-gray-800 text-green-400 p-4 rounded-lg mb-6">
            <div class="font-bold mb-2">Console Debug Script:</div>
            <div class="bg-gray-900 p-2 rounded text-xs overflow-x-auto">
                <pre id="console-script">// Copy and paste this into browser console on main app page
console.log('=== EDIT MODAL BUTTON DEBUG ===');
const generateBtn = document.getElementById('generate-edit-image-btn');
const editModal = document.getElementById('edit-modal');
const wordInput = document.getElementById('edit-word');

console.log('Elements:', { generateBtn, editModal, wordInput });

if (generateBtn) {
    console.log('‚úÖ Generate button found');
    console.log('Disabled:', generateBtn.disabled);
    console.log('Visible:', !generateBtn.closest('.hidden'));
    
    // Test click
    const testClick = () => {
        console.log('üî• TEST CLICK DETECTED!');
        alert('Button click works!');
    };
    generateBtn.addEventListener('click', testClick);
    console.log('Added test listener. Try clicking the button now.');
} else {
    console.log('‚ùå Generate button NOT found');
    console.log('All buttons:', document.querySelectorAll('button[id*="generate"]'));
}

// Check modal visibility
if (editModal) {
    const isVisible = !editModal.classList.contains('hidden');
    console.log('Modal visible:', isVisible);
    if (!isVisible) {
        console.log('üí° TIP: Create a flashcard first, then click edit to open modal');
    }
}</pre>
            </div>
            <button onclick="copyToClipboard()" class="mt-2 px-3 py-1 bg-blue-600 text-white rounded text-sm">
                Copy Script
            </button>
        </div>
        
        <div class="bg-white rounded-lg p-6 shadow-lg mb-6">
            <h2 class="text-lg font-bold mb-4">Expected Console Output</h2>
            <p class="mb-2">When you load the main app, you should see in the console:</p>
            <div class="bg-gray-100 p-3 rounded font-mono text-sm">
                <div>Edit image generation button found, adding event listener</div>
                <div>Regenerate edit image button found, adding event listener</div>
                <div>Remove edit image button found, adding event listener</div>
            </div>
            <p class="mt-2 text-sm text-red-600">
                <strong>If you see error messages instead, that indicates the buttons are not being found in the DOM!</strong>
            </p>
        </div>
        
        <div class="bg-white rounded-lg p-6 shadow-lg">
            <h2 class="text-lg font-bold mb-4">Quick API Test</h2>
            <p class="mb-4">Test if the image generation API is working:</p>
            <button onclick="testAPI()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                Test Image Generation API
            </button>
            <div id="api-result" class="mt-4 p-3 bg-gray-100 rounded hidden">
                <div class="font-bold mb-2">API Result:</div>
                <div id="api-output"></div>
            </div>
        </div>
    </div>

    <script>
        function copyToClipboard() {
            const script = document.getElementById('console-script').textContent;
            navigator.clipboard.writeText(script).then(() => {
                alert('Debug script copied to clipboard!');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = script;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Debug script copied to clipboard!');
            });
        }
        
        async function testAPI() {
            const resultDiv = document.getElementById('api-result');
            const outputDiv = document.getElementById('api-output');
            
            resultDiv.classList.remove('hidden');
            outputDiv.innerHTML = 'Testing API...';
            
            try {
                const response = await fetch('http://localhost:8000/api/ai/image?word_or_phrase=test&language_id=1', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    outputDiv.innerHTML = `
                        <div class="text-green-600 font-bold">‚úÖ API Working!</div>
                        <div>Image URL: ${data.image_url || 'Not provided'}</div>
                        <div>Description: ${data.image_description || 'Not provided'}</div>
                    `;
                } else {
                    outputDiv.innerHTML = `
                        <div class="text-red-600 font-bold">‚ùå API Error!</div>
                        <div>Status: ${response.status}</div>
                        <div>Error: ${JSON.stringify(data)}</div>
                    `;
                }
            } catch (error) {
                outputDiv.innerHTML = `
                    <div class="text-red-600 font-bold">‚ùå Network Error!</div>
                    <div>Error: ${error.message}</div>
                `;
            }
        }
    </script>
</body>
</html>